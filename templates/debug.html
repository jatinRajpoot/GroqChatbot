<!DOCTYPE html>
<html>
<head>
    <title>Chatbot Debug Info</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #fff; }
        .section { margin: 20px 0; padding: 15px; background: #2a2a2a; border-radius: 8px; }
        h2 { color: #10a37f; }
        pre { background: #0f0f0f; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .success { color: #10a37f; }
        .error { color: #ef4444; }
        button { background: #10a37f; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin: 5px; }
        button:hover { background: #0e8c6f; }
    </style>
</head>
<body>
    <h1>üîç Chatbot Debug Information</h1>
    
    <div class="section">
        <h2>Database Stats</h2>
        <button onclick="loadStats()">Refresh Stats</button>
        <pre id="stats">Loading...</pre>
    </div>
    
    <div class="section">
        <h2>All Sessions</h2>
        <button onclick="loadSessions()">Refresh Sessions</button>
        <pre id="sessions">Loading...</pre>
    </div>
    
    <div class="section">
        <h2>Current Session History</h2>
        <button onclick="loadHistory()">Refresh History</button>
        <pre id="history">Loading...</pre>
    </div>
    
    <div class="section">
        <h2>Available Models</h2>
        <button onclick="loadModels()">Refresh Models</button>
        <pre id="models">Loading...</pre>
    </div>
    
    <div class="section">
        <h2>Actions</h2>
        <button onclick="window.location.href='/'">Back to Chat</button>
        <button onclick="clearCurrentSession()">Clear Current Session</button>
    </div>

    <script>
        async function loadStats() {
            try {
                const response = await fetch('/api/stats');
                const data = await response.json();
                document.getElementById('stats').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('stats').textContent = 'Error: ' + error.message;
                document.getElementById('stats').className = 'error';
            }
        }

        async function loadSessions() {
            try {
                const response = await fetch('/api/sessions');
                const data = await response.json();
                document.getElementById('sessions').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('sessions').textContent = 'Error: ' + error.message;
            }
        }

        async function loadHistory() {
            try {
                const response = await fetch('/api/history');
                const data = await response.json();
                document.getElementById('history').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('history').textContent = 'Error: ' + error.message;
            }
        }

        async function loadModels() {
            try {
                const response = await fetch('/api/models');
                const data = await response.json();
                document.getElementById('models').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('models').textContent = 'Error: ' + error.message;
            }
        }

        async function clearCurrentSession() {
            if (confirm('Clear current session messages?')) {
                try {
                    const response = await fetch('/api/clear', { method: 'POST' });
                    const data = await response.json();
                    alert('Session cleared: ' + data.message);
                    loadHistory();
                    loadStats();
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        // Load all data on page load
        window.onload = () => {
            loadStats();
            loadSessions();
            loadHistory();
            loadModels();
        };
    </script>
</body>
</html>
